# 상속보다는 컴포지션을 사용하라

상속은 코드를 재사용할 수 있도록 하는 강력한 수단이지만, 잘못 사용하게 되면 오류를 쉽게 내기 쉬운 소프트웨어를 만들게 된다.

일반적인 구체 클래스를 패키지 경계를 넘어, 다른 패키지의 구체 클래스를 상속하는 것은 위험하다.

<br>

### 상속으로 인해 발생할 수 있는 문제점

* 상속은 메소드 호출과 다르게 캡슐화를 깨뜨린다.
  * 상위 클래스가 어떻게 구현되느냐에 따라 하위 클래스의 동작에 이상이 생길 수 있다.



<br>

### 컴포지션을 사용하자

* 컴포지션이란 기존 클래스를 확장하는 대신, 새로운를 만들고 `private` 필드로 기존 클래스의 인스턴스를 참조하는 방식이다.
* 기존 클래스가 새로운 클래스의 구성요소로 쓰인다.
* 컴포지션을 통해 새로운 클래스가 기존 클래스의 내부 구현 방식의 영향에 벗어날 수 있다.
* 데코레이터 패턴
  * 객체들을 새로운 행동들을 포함한 특수 래퍼 객체들 내에 넣어서 위 본래의 행동을 해당 객체에 연결시키는 구조적 디자인 패턴
* 래퍼 클래스는 콜백 프레임워크와 어울리지 않는다는 것을 제외하고 단점이 거의 없다.
  * **SELF 문제**
    * 콜백 프레임워크에서는 자기 자신의 참조를 다른 객체에 넘겨서 다음 호출 때 사용하도록 한다.
    * 내부 객체는 자신을 감싸고 있는 래퍼의 존재를 모르니, 자신의 참조를 넘기고 콜백 때는 래퍼나 아닌 내부 객체를 호출하게 된다.



<br>

### 정리

* 상속은 코드 재활용성을 가능하게 해주지만, 캡슐화를 해친다는 문제가 있다.
* 상속은 상위 클래스와 하위 클래스가 순수한 is-a 관계일 때에만 사용하자.
* 상속의 취약점을 피하기 위해서 상속 대신 컴포지션과 전달을 사용하자 (래퍼 클래스로 구현할 인터페이스가 있다면 더더욱 !)