# 생성자에 매개변수가 많다면 빌더를 고려하라

**정적 팩터리 메서드와 생성자**는 모두 **선택적 매개변수가 많을 때, 적절히 대응하기 어렵다**는 제약이 있다.

<br>



### 점층적 생성자 패턴

* 선택 매개변수의 모든 경우를 점층적으로 생성자를 만드는 방식
* **단점**
  * 점층적 생성자 패턴을 사용할 수 있지만, 매개변수가 많아지면 코드를 작성하거나 읽기 어려워진다.

<br>



### 자바빈즈 패턴

* 매개변수가 없는 생성자로 객체를 만든 후, `setter` 메서드를 호출해 원하는 매개변수 값을 설정하는 방식
* 점층적 생성자 패턴에 비해 읽기 쉽고, 인스턴스를 만들기 쉽다.
* **단점**
  * 객체를 하나 만들기 위해서 여러 개의 메서드를 호출해야 된다.
  * 객체가 완전히 생성되기 전까지는 **일괄성(consistency)가 무너진 상태**에 놓이게 된다.
    * 일관성이 무너지게 된다면, 매개변수의 유효성을 판단할 수 있는 장치가 사라진 것이기 떄문에 디버깅이 어려워질 수 있음
    * 클래스를 불변으로 만들 수 없으며, 스레드 안정성을 얻기 위해서는 프로그래머가 추가 작업을 해야됨
    * 생성이 끝난 객체를 사용하는 feezing방식이 있지만, 런타임 오류가 취약하며 어려워서 거의 사용되지 않음 



<br>

### 빌더 패턴

* 점층적 생성자 패턴의 안전성과 자바빈즈 패턴의 가독성을 겸비한 패턴
* **사용 방법**
  1. 필수 매개변수만으로 생성자(혹은 정적 팩터리)를 호출해 빌더 객체를 얻는다.
  2. 빌더 객체가 제공하는 메서드를 통해 원하는 선택 매개변수를 설정한다.
  3. `build` 메서드를 호출하여 필요한 객체를 얻는다.
* **장점**
  * 계층적으로 설계된 클래스와 함께 사용하기에도 좋다.
  * 가변인수 매개변수를 여러 개 사용할 수 있다.
* **단점**
  * 객체를 만들기 이전에 빌더부터 만들어야되기 때문에 성능에 민감한 상황에서 문제가 될 수 있다.
  * 점층적 방식과 비표시 코드가 장황하고, 매개변수가 4개 미만이라면 점층적 방식을 사용하는 것이 나을 수 있다.

<br>



### 정리

생성자나 정적 팩터리가 처리해야되는 매개변수가 많다면, 빌더 패턴을 사용하는게 낫다!

